<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>KLYRO Checkout</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
<style>
body{
  margin:0;
  font-family: Arial, sans-serif;
  background:#0b0b0b;
  color:white;
}

/* --- TOPBAR --- */
nav{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:15px 30px;
  background:#111;
  box-shadow:0 2px 10px rgba(0,0,0,0.5);
}
nav h2{margin:0;font-size:24px;}
nav .cart{
  background:#fff;
  color:#111;
  padding:8px 16px;
  border-radius:20px;
  transition:transform 0.2s, box-shadow 0.2s;
}
nav .cart:hover{
  transform:scale(1.05);
  box-shadow:0 4px 12px rgba(255,255,255,0.3);
}

/* --- CHECKOUT BOX --- */
.box{
  max-width:500px;
  margin:50px auto;
  background:#111;
  padding:20px;
  border-radius:12px;
  box-shadow:0 0 10px #000;
  transition:transform 0.3s;
}
.box:hover{
  transform:translateY(-5px);
}

/* --- ITEMS --- */
.item{
  padding:10px;
  border-bottom:1px solid #222;
  transition:background 0.3s;
}
.item:hover{
  background:#222;
}

/* --- BUTTONS --- */
button{
  margin-top:15px;
  padding:10px 25px;
  border:none;
  border-radius:25px;
  background:#fff;
  color:#111;
  font-weight:bold;
  cursor:pointer;
  transition: background 0.3s, transform 0.2s;
}
button:hover{
  background:#ff5e5e;
  color:white;
  transform:scale(1.05);
}

/* --- INPUT --- */
input{
  padding:10px;
  width:90%;
  margin-top:10px;
  border-radius:12px;
  border:none;
}
</style>
</head>
<body>

<!-- TOPBAR -->
<nav>
  <h2>KLYRO Checkout</h2>
  <div class="cart">ðŸ›’ Items: <span id="count">0</span></div>
</nav>

<!-- CHECKOUT BOX -->
<div class="box">
  <div id="items"></div>
  <b>Total: $<span id="total">0</span></b>
  <br><br>
  <input id="email" placeholder="Enter your email for receipt">
  <br>
  <button onclick="buy()">Confirm Purchase</button>
</div>

<script>
/* --- EMAILJS CONFIG --- */
emailjs.init("PASTE_PUBLIC_KEY"); // your EmailJS public key
const SERVICE_ID = "PASTE_SERVICE_ID"; // your EmailJS service ID
const TEMPLATE_ID = "template_7hoecnn"; // your template ID

/* --- CART LOGIC --- */
const prices = {
  "PFP Pack":5,
  "Wallpaper":3,
  "Creator Bundle":10
};

let cart = JSON.parse(localStorage.getItem("cart") || "[]");

// Show cart count
document.getElementById("count").innerText = cart.length;

// Show cart items
const itemsEl = document.getElementById("items");
let sum = 0;

if(cart.length === 0){
  itemsEl.innerHTML = "Cart is empty!";
} else {
  itemsEl.innerHTML = cart.map(item=>{
    sum += prices[item];
    return `<div class="item">${item} - $${prices[item]}</div>`;
  }).join("");
}

document.getElementById("total").innerText = sum;

// BUY / SEND EMAIL
function buy(){
  const userEmail = document.getElementById("email").value;
  if(!userEmail) return alert("Enter email!");
  if(cart.length === 0) return alert("Cart empty!");

  emailjs.send(SERVICE_ID, TEMPLATE_ID, {
    to_email: userEmail,
    items: cart.join(", "),
    total: sum
  }).then(()=>{
    alert("Purchase complete! Receipt sent to " + userEmail);
    localStorage.removeItem("cart"); // clear cart
    window.location.href = "index.html";
  }).catch(err=>{
    console.error(err);
    alert("Error sending email. Try again.");
  });
}
</script>

</body>
</html>
